require 'ant'
require 'ivy/rake'
require 'cucumber/rake/task'

VERSION_NUMBER = "1.0.0"
GROUP = "bluemount"

TARGET_JAVA = 'target/java'
TARGET_TEST_JAVA = 'target/test/java'

task :default => :jar


build_dir = TARGET_JAVA
file build_dir

task :setup => [build_dir, "ivy:setup"] do
  ant.property :name => "src.dir", :value => "src/main/java"
  ant.path(:id => "project.class.path") do
    pathelement :location => "classes"
  end
end

task :compile => :setup do
  mkdir_p build_dir
  ant.javac(:destdir => build_dir) do
    classpath :refid => "project.class.path"
    src { pathelement :location => "${src.dir}" }
  end
end

task :jar => :compile do
  ant.jar :destfile => "urlverifier.jar", :basedir => build_dir
end

Cucumber::Rake::Task.new(:features => task('compile')) do |t|
  t.cucumber_opts = %w{--format junit    --out reports/cucumber
                       --format progress --out reports/cucumber/features.log
                       --format html     --out reports/cucumber/features.html}
end